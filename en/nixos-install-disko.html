<!DOCTYPE html>
<!-- DoNotFormat -->
<!-- DoNotFormat -->




<!-- DoNotFormat -->
<!-- DoNotFormat -->

<html lang='en'>

<head>
  <meta charset='UTF-8' />
  <meta name='viewport' content='width=device-width, initial-scale=1' />
  <title>
    Install NixOS with disko disk partitioning – NixOS Asia
  </title>
  
    
      <meta property='og:description' content='In this second tutorial, we will walk you through the process of installing NixOS. Unlike the first installation tutorial, we will use the command line to install NixOS manually, except for using disko to specify disk partitions declaratively in Nix itself. This is the first step toward our next tutorial, where we will automate the entire installation process.NixOSthe first installation tutorialdiskoNixnext tutorial' />
      <meta property='og:site_name' content='NixOS Asia' />
      <meta property='og:image' content='https://nixos.asia/en/nixos-install-disko/nixos-disko-config.jpeg' />
      <meta property='og:type' content='website' />
      <meta property='og:title' content='Install NixOS with disko disk partitioning' />
      
        <meta name='twitter:card' content='summary_large_image' />
      
    
    
      <base href='/en/' />
      <link href='static/nixos-asia.svg' rel='icon' />
    
    <!-- highlight.js -->
<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/hybrid.min.css' />
<script src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js'></script>
<!-- Include languages that Emanote itself uses -->
<script src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/languages/haskell.min.js'></script>
<script src='https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/languages/nix.min.js'></script>
<script>hljs.highlightAll();</script>



  
  
  <link href='tailwind.css?instanceId=0c252e3a-e1d9-413b-a151-869565fd84fc' rel='stylesheet' type='text/css' />

  <style>
    /* Heist error element */
    strong.error {
      color: lightcoral;
      font-size: 90%;
      font-family: monospace;
    }

    /* <kbd> styling */
    kbd {
      background-color: #eee;
      border-radius: 3px;
      border: 1px solid #b4b4b4;
      box-shadow:
        0 1px 1px rgba(0, 0, 0, 0.2),
        0 2px 0 0 rgba(255, 255, 255, 0.7) inset;
      display: inline-block;
      line-height: 1;
      padding: 2px 4px;
      white-space: nowrap;
    }

    /* Callouts */
    div.callout {
      background-color: #f5f5f5;
      padding: 1em 1em 0.5em;
      border-radius: 0.5em;
      margin-bottom: 1em;
    }

    .callout[data-callout="note"] {
      --callout-color: 8, 109, 221;
    }

    .callout[data-callout="info"] {
      --callout-color: 8, 109, 221;
    }

    .callout[data-callout="tip"] {
      --callout-color: 8, 191, 188;
    }

    .callout[data-callout="warning"] {
      --callout-color: 236, 117, 0;
    }

    .callout[data-callout="failure"] {
      --callout-color: 233, 49, 71;
    }

    div.callout {
      background-color: rgba(var(--callout-color), 0.1);
    }

    .callout .callout-title {
      color: rgb(var(--callout-color));
    }

    div.callout-title {
      display: flex;
      align-items: center;
      margin-bottom: 0.5em;
      font-variation-settings: 'wght' 600;
    }

    div.callout-title div.callout-title-inner {
      margin-left: 0.5em;
    }

    a.--ema-toc:not(.toc-item-active) {
      background-color: #ffffff !important;
    }

    /* External link icon */
    a[data-linkicon=""]::after {
      content: ""
    }

    a[data-linkicon=none]::after {
      content: ""
    }

    a[data-linkicon="external"] {
      padding-right: 24px;
    }

    a[data-linkicon="external"]::after {
      margin-right: -24px;
      content: url('data:image/svg+xml,\
      <svg xmlns="http://www.w3.org/2000/svg" height="0.7em" viewBox="0 0 20 20"> \
        <g style="stroke:gray;stroke-width:1"> \
          <line x1="5" y1="5" x2="5" y2="14" /> \
          <line x1="14" y1="9" x2="14" y2="14" /> \
          <line x1="5" y1="14" x2="14" y2="14" /> \
          <line x1="5" y1="5" x2="9" y2="5"  /> \
          <line x1="10" y1="2" x2="17" y2="2"  /> \
          <line x1="17" y1="2" x2="17" y2="9" /> \
          <line x1="10" y1="9" x2="17" y2="2" style="stroke-width:1.0" /> \
        </g> \
      </svg>');
    }

    a[data-linkicon="external"][href^="mailto:"]::after {
      content: url('data:image/svg+xml,\
        <svg \
          xmlns="http://www.w3.org/2000/svg" \
          height="0.7em" \
          fill="none" \
          viewBox="0 0 24 24" \
          stroke="gray" \
          stroke-width="2"> \
          <path \
            stroke-linecap="round" \
            stroke-linejoin="round" \
            d="M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z" /> \
        </svg>');
    }
  </style>
  <!-- What goes in this file will appear on near the end of <head>--><link rel='preload' href='_emanote-static/fonts/Work_Sans/WorkSans-VariableFont_wght.ttf' as='font' type='font/ttf' crossorigin />

<style>
  @font-face {
    font-family: 'WorkSans';
    /* FIXME: This ought to be: ${ema:emanoteStaticLayerUrl}/fonts/Work_Sans/WorkSans-VariableFont_wght.ttf */
    src: url(_emanote-static/fonts/Work_Sans/WorkSans-VariableFont_wght.ttf) format("truetype");
    font-display: swap;
  }

  body {
    font-family: 'WorkSans', sans-serif;
    font-variation-settings: 'wght' 350;
  }

  a.mavenLinkBold {
    font-variation-settings: 'wght' 400;
  }

  strong {
    font-variation-settings: 'wght' 500;
  }

  h1,
  h2,
  h3,
  h4,
  h5,
  h6,
  header,
  .header-font {
    font-family: 'WorkSans', sans-serif;
  }

  h1 {
    font-variation-settings: 'wght' 500;
  }

  h2 {
    font-variation-settings: 'wght' 400;
  }

  h3 {
    font-variation-settings: 'wght' 300;
  }
</style>


  
    <style>
      /* For use in sidebar.tpl, as we cannot achieve this in tailwind itself! */
      /* md:min-w-48  */
      @media (min-width: 768px) {
        #sidebar {
          min-width: 12rem;
        }
      }

      /* xl:min-w-64  */
      @media (min-width: 1280px) {
        #sidebar {
          min-width: 16rem;
        }
      }
    </style>

    
      <link rel='stylesheet' href='_emanote-static/inverted-tree.css' />
    
  
  <link rel='stylesheet' href='_emanote-static/stork/flat.css' />
<!-- Custom Stork-search styling for Emanote -->
<style>
  #stork-search-container {
    z-index: 1000;
    background-color: rgb(15 23 42/.8);
  }

  .stork-overflow-hidden-important {
    overflow: hidden !important;
  }
</style>


<script src='_emanote-static/stork/stork.js'></script>

  
    <script id='emanote-stork' data-emanote-base-url='/en/'>
      window.emanote = {};
      window.emanote.stork = {
        searchShown: false,
        indexIsStale: false,
        toggleSearch: function () {
          window.emanote.stork.refreshIndex();
          document.getElementById('stork-search-container').classList.toggle('hidden');
          window.emanote.stork.searchShown = document.body.classList.toggle('stork-overflow-hidden-important');
          if (window.emanote.stork.searchShown) {
            document.getElementById('stork-search-input').focus();
          }
        },
        clearSearch: function () {
          document.getElementById('stork-search-container').classList.add('hidden');
          document.body.classList.remove('stork-overflow-hidden-important');
          window.emanote.stork.searchShown = false;
        },

        getBaseUrl: function () {
          const baseUrl = document.getElementById("emanote-stork").getAttribute('data-emanote-base-url') || '/';
          return baseUrl;
        },

        registerIndex: function (options) {
          const indexName = 'emanote-search'; // used to match input[data-stork] attribute value
          const indexUrl = window.emanote.stork.getBaseUrl() + '-/stork.st';
          stork.register(
            indexName,
            indexUrl,
            options);
        },

        init: function () {
          if (document.readyState !== 'complete') {
            window.addEventListener('load', function () {
              stork.initialize(window.emanote.stork.getBaseUrl() + '_emanote-static/stork/stork.wasm');
              window.emanote.stork.registerIndex();
            });

            document.addEventListener('keydown', event => {
              if (window.emanote.stork.searchShown && event.key === 'Escape') {
                window.emanote.stork.clearSearch();
                event.preventDefault();
              } else if ((event.key == 'k' || event.key == 'K') && (event.ctrlKey || event.metaKey)) {
                window.emanote.stork.toggleSearch();
                event.preventDefault();
              }
            });
          } else {
            // This section is called during Ema's hot reload.
            // 
            // Mark the current index as stale, and refresh it *only when* the
            // user actually invokes search.
            // 
            // We do not refresh the index *right away*, as that will cause
            // memory leaks in the browser. See
            // https://github.com/srid/emanote/issues/411#issuecomment-1402056235
            console.log("stork: Marking index as stale");
            window.emanote.stork.markIndexAsStale();
          }
        },

        markIndexAsStale: function () {
          window.emanote.stork.indexIsStale = true;
        },

        refreshIndex: function () {
          if (window.emanote.stork.indexIsStale) {
            console.log("stork: Reloading index");
            window.emanote.stork.indexIsStale = false;
            // NOTE: This will leak memory. See the comment above.
            window.emanote.stork.registerIndex({ forceOverwrite: true });
          }
        }

      };

      window.emanote.stork.init();
    </script>
  

</head>

<!-- DoNotFormat -->



<!-- DoNotFormat -->

<body class='bg-gray-400 overflow-y-scroll'>
  
    <div class='container mx-auto mt-2 md:mt-4  '>
      
        <!-- DoNotFormat -->
<!-- DoNotFormat -->

<nav id='uptree' class='flipped tree' style='transform-origin: 50%;'>
  <ul class='root'>
    <li>
      
        <ul>
          
            <li>

  <a href='nixos-tutorial'>
    <div class='text-gray-900 hover:bg-green-500 hover:text-white cursor-pointer forest-link'>
      NixOS Tutorial Series
    </div>
  </a>

  
    <ul>
      
        <li>

  <a href='nixos'>
    <div class='text-gray-900 hover:bg-green-500 hover:text-white cursor-pointer forest-link'>
      NixOS
    </div>
  </a>

  
    <ul>
      
        <li>

  <a href='topics'>
    <div class='text-gray-900 hover:bg-green-500 hover:text-white cursor-pointer forest-link'>
      Topics
    </div>
  </a>

  
    <ul>
      
        <li>

  <a href=''>
    <div class='text-gray-900 hover:bg-green-500 hover:text-white cursor-pointer forest-link'>
      NixOS Asia
    </div>
  </a>

  
</li>
      
    </ul>
  
</li>
      
    </ul>
  
</li>
      
        <li>

  <a href='tutorial'>
    <div class='text-gray-900 hover:bg-green-500 hover:text-white cursor-pointer forest-link'>
      Tutorials
    </div>
  </a>

  
</li>
      
    </ul>
  
</li>
          
        </ul>
      
    </li>
  </ul>
</nav>
      

      
        <nav id='breadcrumbs' class='w-full text-gray-700 md:hidden'>
  <div class='flex justify-left'>
    <div class='w-full px-2 py-2 bg-gray-50'>
      <ul class='flex flex-wrap text-lg'>
        <li class='inline-flex items-center'>
          
            
              <img style='width: 1rem;' src='static/nixos-asia.svg' />
            
          
        </li>
        
          
            <li class='inline-flex items-center'>
              <a class='px-1 font-bold' href=''>
                NixOS Asia
              </a>
              <svg fill='currentColor' viewBox='0 0 20 20' class='w-auto h-5 text-gray-400'>
                <path fill-rule='evenodd' d='M7.293 14.707a1 1 0 010-1.414L10.586 10 7.293 6.707a1 1 0 011.414-1.414l4 4a1 1 0 010 1.414l-4 4a1 1 0 01-1.414 0z' clip-rule='evenodd'></path>
              </svg>
            </li>
          
        
      </ul>
    </div>
    <button class='inline px-2 py-1 bg-gray-50 outline-none cursor-pointer focus:outline-none' title='Search (Ctrl+K)' type='button' onclick='window.emanote.stork.toggleSearch()'>
      <svg xmlns='http://www.w3.org/2000/svg' style='width: 1rem;' class='hover:text-green-700' f
 fill='none' viewBox='0 0 24 24' stroke='currentColor' stroke-width='2'>
  <path stroke-linecap='round' stroke-linejoin='round' d='M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z'></path>
</svg>
    </button>
    <button class='inline px-2 py-1 text-white bg-green-600 outline-none cursor-pointer focus:outline-none' title='Toggle sidebar' type='button' onclick="toggleHidden('sidebar')">
      <svg xmlns='http://www.w3.org/2000/svg' class='w-4' fill='none' viewBox='0 0 24 24' stroke='currentColor'>
        <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M4 6h16M4 12h16M4 18h16'></path>
      </svg>
    </button>
    <script>
      function toggleHidden(elemId) {
        document.getElementById(elemId).classList.toggle("hidden");
      }
    </script>
  </div>
</nav>
      

      
        <div id='container' class='relative md:shadow-2xl md:mb-8'>
          
  <div class='absolute -top-6 right-1 md:right-0 flex flex-row items-center justify-center'>
    <a title='Search (Ctrl+K)' class='cursor-pointer' onclick='window.emanote.stork.toggleSearch()'>
      <svg xmlns='http://www.w3.org/2000/svg' style='width: 1rem;' class='hover:text-green-700' f
 fill='none' viewBox='0 0 24 24' stroke='currentColor' stroke-width='2'>
  <path stroke-linecap='round' stroke-linejoin='round' d='M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z'></path>
</svg>
    </a>
  </div>

          <!-- Main body column -->
          <div class='flex-1 w-full bg-white'>
  <main class='px-4 py-4'>
    <h1 class='flex items-end justify-center mb-4 p-3 bg-green-100 text-5xl font-extrabold text-black rounded'>
  <a class='z-40 tracking-tighter '>
    Install NixOS with <code>disko</code> disk partitioning
  </a>
</h1>
    
      <article class='overflow-auto'>
  <!-- What goes in this file will appear on top of note body-->
  






    <p class='mb-3'>
      In this second tutorial, we will walk you through the process of installing <a href='nixos' class='text-green-600 mavenLinkBold hover:underline' data-wikilink-type='WikiLinkNormal'>NixOS</a>. Unlike <a href='nixos-install-flake' class='text-green-600 mavenLinkBold hover:underline' data-wikilink-type='WikiLinkNormal'>the first installation tutorial</a>, we will use the command line to install NixOS manually, except for using <a href='https://github.com/nix-community/disko' class='text-green-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>disko</a> to specify disk partitions declaratively in <a href='nix' class='text-green-600 mavenLinkBold hover:underline' data-wikilink-type='WikiLinkNormal'>Nix</a> itself. This is the first step toward our <a href='nixos-install-oneclick' class='text-green-600 mavenLinkBold hover:underline' data-wikilink-type='WikiLinkNormal'>next tutorial</a>, where we will automate the entire installation process.
    </p>
  
    <h2 id='prepare' class='group mt-6 mb-4 font-bold text-gray-700 text-4xl'>
      
  Prepare to install NixOS
  
  <a href='nixos-install-disko#prepare' class='--ema-anchor'>
    <span class='hover:text-green-400 group-hover:visible invisible cursor-pointer text-sm align-middle' aria-label='Copy link'><svg class='inline w-4' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'>
        <path d='M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71'></path>
        <path d='M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71'></path>
      </svg></span>
  </a>


    </h2>
  <div data-callout-metadata data-callout-fold data-callout='note' class='callout bg-opacity-10' role='note'>
  <path d='M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z'>
  </path>
  <div class='callout-title'>
    <div class='callout-icon'>
      <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round' class='w-5 h-5'>
        <line x1='18' y1='2' x2='22' y2='6'></line>
<path d='M7.5 20.5 19 9l-4-4L3.5 16.5 2 22z'></path>
      </svg>
    </div>
    <div class='callout-title-inner'>
       Minimal ISO image
    </div>
  </div>
  <div class='callout-content'>
    
    <p class='mb-3'>
      This tutorial doesn’t use a <a href='nixos-install-flake' class='text-green-600 mavenLinkBold hover:underline' data-wikilink-type='WikiLinkNormal'>graphical installer</a>. Instead, it uses the minimal ISO image. This is primarily because we don’t want the installer to partion the disk for us. We will use <a href='https://github.com/nix-community/disko' class='text-green-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>disko</a> to do that.
    </p>
  
  </div>
</div>
    <ul class='my-3 ml-6 space-y-1 list-disc'>
      
        <li>
          Download the latest NixOS ISO from <a href='https://nixos.org/download#download-nixos' class='text-green-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>here</a>. Choose the “Minimal ISO image” for your architecture.
        </li>
      
        <li>
          Create a bootable USB flash drive (<a href='https://nixos.org/manual/nixos/stable/index.html#sec-booting-from-usb' class='text-green-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>instructions here</a>)
        </li>
      
    </ul>
  
    <p class='mb-3'>
      Boot your computer from this USB flash drive, and expect to be greeted with a command line interface (CLI):
    </p>
  <div class='flex justify-center items-center mx-auto'><img class='inline mb-3' src='nixos-install-disko/nixos-installer-cli.jpeg' alt='/nix/store/1c99jp7g8w8qilv1mpw8sw7s19v6h57f-global/nixos-install-disko/nixos-installer-cli.jpeg' style='width: inherit;' /></div>
    <h2 id='partition' class='group mt-6 mb-4 font-bold text-gray-700 text-4xl'>
      
  Partition the disk
  
  <a href='nixos-install-disko#partition' class='--ema-anchor'>
    <span class='hover:text-green-400 group-hover:visible invisible cursor-pointer text-sm align-middle' aria-label='Copy link'><svg class='inline w-4' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'>
        <path d='M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71'></path>
        <path d='M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71'></path>
      </svg></span>
  </a>


    </h2>
  
    <p class='mb-3'>
      Before installing NixOS, let’s define our partition layout in Nix. We will follow <a href='https://github.com/nix-community/disko/blob/master/docs/quickstart.md' class='text-green-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>the official disko documentation</a> and include screenshots wherever necessary. Finally, we will use flakes to manage the configuration.
    </p>
  
    <h3 id='disk-config' class='group mt-6 mb-4 font-bold text-gray-700 text-3xl'>
      
  Choosing the disk configuration
  
  <a href='nixos-install-disko#disk-config' class='--ema-anchor'>
    <span class='hover:text-green-400 group-hover:visible invisible cursor-pointer text-sm align-middle' aria-label='Copy link'><svg class='inline w-4' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'>
        <path d='M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71'></path>
        <path d='M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71'></path>
      </svg></span>
  </a>


    </h3>
  
    <p class='mb-3'>
      Instead of creating our partition layout from scratch, we can choose one of the examples Disko itself provides (see <a href='https://github.com/nix-community/disko/tree/master/example' class='text-green-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>here</a>). We will use the <a href='https://github.com/nix-community/disko/blob/master/example/hybrid.nix' class='text-green-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>hybrid</a> example as it will work for both BIOS and UEFI systems.
    </p>
  
    <p class='mb-3'>
      Retrieve the disk configuration to a temporary location, calling it <code class='py-0.5 px-0.5 bg-gray-100'>disko-config.nix</code> (we will use it latter):
    </p>
  <div class='py-0.5 mb-3 text-sm'><pre><code class='bash language-bash'>curl https://raw.githubusercontent.com/nix-community/disko/master/example/hybrid.nix -o /tmp/disko-config.nix</code></pre></div>
    <h3 id='disk-config-edit' class='group mt-6 mb-4 font-bold text-gray-700 text-3xl'>
      
  Modify the disk configuration
  
  <a href='nixos-install-disko#disk-config-edit' class='--ema-anchor'>
    <span class='hover:text-green-400 group-hover:visible invisible cursor-pointer text-sm align-middle' aria-label='Copy link'><svg class='inline w-4' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'>
        <path d='M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71'></path>
        <path d='M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71'></path>
      </svg></span>
  </a>


    </h3>
  
    <p class='mb-3'>
      The above downloaded Nix file uses a hardcoded disk device. So, we need to replace it with the device name of the disk we want to install <a href='nixos' class='text-green-600 mavenLinkBold hover:underline' data-wikilink-type='WikiLinkNormal'>NixOS</a> on. We can use <code class='py-0.5 px-0.5 bg-gray-100'>lsblk</code> to find it.
    </p>
  <div class='flex justify-center items-center mx-auto'><img class='inline mb-3' src='nixos-install-disko/nixos-lsblk.jpeg' alt='/nix/store/1c99jp7g8w8qilv1mpw8sw7s19v6h57f-global/nixos-install-disko/nixos-lsblk.jpeg' style='width: inherit;' /></div>
    <p class='mb-3'>
      In this case, the device name is <code class='py-0.5 px-0.5 bg-gray-100'>vda</code>. The device file is located at <code class='py-0.5 px-0.5 bg-gray-100'>/dev/vda</code>. We will use this to modify <code class='py-0.5 px-0.5 bg-gray-100'>disko-config.nix</code> we downloaded earlier.
    </p>
  <div class='flex justify-center items-center mx-auto'><img class='inline mb-3' src='nixos-install-disko/nixos-disko-config.jpeg' alt='/nix/store/1c99jp7g8w8qilv1mpw8sw7s19v6h57f-global/nixos-install-disko/nixos-disko-config.jpeg' style='width: inherit;' /></div>
    <h3 id='run-the-partitioning-script' class='group mt-6 mb-4 font-bold text-gray-700 text-3xl'>
      
  Run the partitioning script
  
  <a href='nixos-install-disko#run-the-partitioning-script' class='--ema-anchor'>
    <span class='hover:text-green-400 group-hover:visible invisible cursor-pointer text-sm align-middle' aria-label='Copy link'><svg class='inline w-4' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'>
        <path d='M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71'></path>
        <path d='M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71'></path>
      </svg></span>
  </a>


    </h3>
  
    <p class='mb-3'>
      The disko flake provides an app that will take our partitioning scheme defined in Nix file above, partition the specified disk device and mount it at <code class='py-0.5 px-0.5 bg-gray-100'>/mnt</code>. We want this to happen prior to installing NixOS. Let’s do that now:
    </p>
  <div class='py-0.5 mb-3 text-sm'><pre><code class='bash language-bash'>sudo nix \
  --experimental-features "nix-command flakes" \
  run github:nix-community/disko -- \
  --mode disko /tmp/disko-config.nix</code></pre></div>
    <p class='mb-3'>
      Once the command completes, you should see the disk partitioned and mounted at <code class='py-0.5 px-0.5 bg-gray-100'>/mnt</code>:
    </p>
  <div class='flex justify-center items-center mx-auto'><img class='inline mb-3' src='nixos-install-disko/nixos-disko-post-partition.jpeg' alt='/nix/store/1c99jp7g8w8qilv1mpw8sw7s19v6h57f-global/nixos-install-disko/nixos-disko-post-partition.jpeg' style='width: inherit;' /></div>
    <h2 id='configuration' class='group mt-6 mb-4 font-bold text-gray-700 text-4xl'>
      
  Generate initial NixOS configuration
  
  <a href='nixos-install-disko#configuration' class='--ema-anchor'>
    <span class='hover:text-green-400 group-hover:visible invisible cursor-pointer text-sm align-middle' aria-label='Copy link'><svg class='inline w-4' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'>
        <path d='M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71'></path>
        <path d='M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71'></path>
      </svg></span>
  </a>


    </h2>
  
    <p class='mb-3'>
      With the disk partitioned, we are ready to follow the usual NixOS installation process. The first step is to generate the initial NixOS configuration under <code class='py-0.5 px-0.5 bg-gray-100'>/mnt</code>.
    </p>
  <div class='py-0.5 mb-3 text-sm'><pre><code class='bash language-bash'>sudo nixos-generate-config --no-filesystems --root /mnt</code></pre></div><div data-callout-metadata data-callout-fold data-callout='tip' class='callout bg-opacity-10' role='note'>
  <path d='M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z'>
  </path>
  <div class='callout-title'>
    <div class='callout-icon'>
      <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round' class='w-5 h-5'>
        <path d='M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z'>
</path>
      </svg>
    </div>
    <div class='callout-title-inner'>
       Why <code class='py-0.5 px-0.5 bg-gray-100'>--no-filesystems</code> and <code class='py-0.5 px-0.5 bg-gray-100'>--root</code>?
    </div>
  </div>
  <div class='callout-content'>
    
    <ul class='my-3 ml-6 space-y-1 list-disc'>
      
        <li>
          The <a href='https://search.nixos.org/options?channel=23.11&amp;show=fileSystems&amp;from=0&amp;size=50&amp;sort=relevance&amp;type=packages&amp;query=fileSystems' class='text-green-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>fileSystems</a> configuration will automatically be added by <code class='py-0.5 px-0.5 bg-gray-100'>disko</code>’s <a href='https://nixos.wiki/wiki/NixOS_modules' class='text-green-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>nixosModule</a> (see below). Therefore, we use <code class='py-0.5 px-0.5 bg-gray-100'>--no-filesystems</code> to avoid generating it here.
        </li>
      
        <li>
          <code class='py-0.5 px-0.5 bg-gray-100'>--root</code> is to specify the mountpoint to generate <code class='py-0.5 px-0.5 bg-gray-100'>configuration.nix</code> and <code class='py-0.5 px-0.5 bg-gray-100'>hardware-configuration.nix</code> in. Here, our configuration will be generated in <code class='py-0.5 px-0.5 bg-gray-100'>/mnt/etc/nixos</code>.
        </li>
      
    </ul>
  
  </div>
</div>
    <h2 id='flakeify' class='group mt-6 mb-4 font-bold text-gray-700 text-4xl'>
      
  Flakeify the configuration
  
  <a href='nixos-install-disko#flakeify' class='--ema-anchor'>
    <span class='hover:text-green-400 group-hover:visible invisible cursor-pointer text-sm align-middle' aria-label='Copy link'><svg class='inline w-4' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'>
        <path d='M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71'></path>
        <path d='M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71'></path>
      </svg></span>
  </a>


    </h2>
  
    <p class='mb-3'>
      Before we can utilize <code class='py-0.5 px-0.5 bg-gray-100'>disko</code> in our generated configuration, we will <a href='configuration-as-flake' class='text-green-600 mavenLinkBold hover:underline' data-wikilink-type='WikiLinkNormal'>convert our configuration to a flake</a>. This is a simple process of adding a <code class='py-0.5 px-0.5 bg-gray-100'>flake.nix</code> file in <code class='py-0.5 px-0.5 bg-gray-100'>/mnt/etc/nixos</code>:
    </p>
  <div class='py-0.5 mb-3 text-sm'><pre><code class='bash language-bash'># /mnt/etc/nixos/flake.nix
{
  inputs = {
    # NOTE: Replace "nixos-23.11" with that which is in system.stateVersion of
    # configuration.nix. You can also use latter versions if you wish to
    # upgrade.
    nixpkgs.url = "github:NixOS/nixpkgs/nixos-23.11";
  };
  outputs = inputs@{ self, nixpkgs, ... }: {
    # NOTE: 'nixos' is the default hostname set by the installer
    nixosConfigurations.nixos = nixpkgs.lib.nixosSystem {
      # NOTE: Change this to aarch64-linux if you are on ARM
      system = "x86_64-linux";
      modules = [ ./configuration.nix ];
    };
  };
}</code></pre></div><div data-callout-metadata data-callout-fold data-callout='note' class='callout bg-opacity-10' role='note'>
  <path d='M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z'>
  </path>
  <div class='callout-title'>
    <div class='callout-icon'>
      <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round' class='w-5 h-5'>
        <line x1='18' y1='2' x2='22' y2='6'></line>
<path d='M7.5 20.5 19 9l-4-4L3.5 16.5 2 22z'></path>
      </svg>
    </div>
    <div class='callout-title-inner'>
       Make sure to change a couple of things in the above snippet:
    </div>
  </div>
  <div class='callout-content'>
    
    <ul class='my-3 ml-6 space-y-1 list-disc'>
      
        <li>
          Replace <code class='py-0.5 px-0.5 bg-gray-100'>nixos-23.11</code> with the version from <a href='https://nixos.wiki/wiki/FAQ/When_do_I_update_stateVersion' class='text-green-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'><code class='py-0.5 px-0.5 bg-gray-100'>system.stateVersion</code></a> in your <code class='py-0.5 px-0.5 bg-gray-100'>/mnt/etc/nixos/configuration.nix</code>. If you wish to upgrade right away, you can also use latter versions, or use <code class='py-0.5 px-0.5 bg-gray-100'>nixos-unstable</code> for the bleeding edge.
        </li>
      
        <li>
          <code class='py-0.5 px-0.5 bg-gray-100'>x86_64-linux</code> should be <code class='py-0.5 px-0.5 bg-gray-100'>aarch64-linux</code> if you are on ARM
        </li>
      
    </ul>
  
  </div>
</div>
    <p class='mb-3'>
      For details, see <a href='configuration-as-flake' class='text-green-600 mavenLinkBold hover:underline' data-wikilink-type='WikiLinkNormal'>Convert <code class='py-0.5 px-0.5 bg-gray-100'>configuration.nix</code> to be a flake</a>.
    </p>
  
    <h2 id='add-disko' class='group mt-6 mb-4 font-bold text-gray-700 text-4xl'>
      
  Add the <code class='py-0.5 px-0.5 bg-gray-100'>disko</code> nixosModule
  
  <a href='nixos-install-disko#add-disko' class='--ema-anchor'>
    <span class='hover:text-green-400 group-hover:visible invisible cursor-pointer text-sm align-middle' aria-label='Copy link'><svg class='inline w-4' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'>
        <path d='M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71'></path>
        <path d='M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71'></path>
      </svg></span>
  </a>


    </h2>
  
    <p class='mb-3'>
      Our NixOS configuration still does not know anything about filesystems. Let’s teach it just that by using the previously downloaded disko example. We do this by adding the <code class='py-0.5 px-0.5 bg-gray-100'>disko</code> flake input, importing its NixOS module before importing our <code class='py-0.5 px-0.5 bg-gray-100'>/tmp/disko-config.nix</code>.
    </p>
  
    <ul class='my-3 ml-6 space-y-1 list-decimal list-inside'>
      
        <li>
          
    <p class='mb-3'>
      Add the <code class='py-0.5 px-0.5 bg-gray-100'>disko</code> flake input in <code class='py-0.5 px-0.5 bg-gray-100'>/mnt/etc/nixos/flake.nix</code>:
    </p>
  <div class='py-0.5 mb-3 text-sm'><pre><code class='nix language-nix'># In `/mnt/etc/nixos/flake.nix`
{
  inputs = {
    disko.url = "github:nix-community/disko";
    disko.inputs.nixpkgs.follows = "nixpkgs";
  };
}</code></pre></div><div data-callout-metadata data-callout-fold data-callout='info' class='callout bg-opacity-10' role='note'>
  <path d='M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z'>
  </path>
  <div class='callout-title'>
    <div class='callout-icon'>
      <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round' class='w-5 h-5'>
        <circle cx='12' cy='12' r='10'></circle>
<line x1='12' y1='16' x2='12' y2='12'></line>
<line x1='12' y1='8' x2='12.01' y2='8'></line>
      </svg>
    </div>
    <div class='callout-title-inner'>
       Why the “follows”?
    </div>
  </div>
  <div class='callout-content'>
    
    <p class='mb-3'>
      <code class='py-0.5 px-0.5 bg-gray-100'>disko.inputs.nixpkgs.follows = "nixpkgs";</code> is to ensure that <code class='py-0.5 px-0.5 bg-gray-100'>disko</code> uses the same version of <code class='py-0.5 px-0.5 bg-gray-100'>nixpkgs</code> as specified in the current flake. This avoids having two different sources of <code class='py-0.5 px-0.5 bg-gray-100'>nixpkgs</code> and saves space.
    </p>
  
  </div>
</div>
        </li>
      
        <li>
          
    <p class='mb-3'>
      Add the <code class='py-0.5 px-0.5 bg-gray-100'>disko</code> nixosModule:
    </p>
  <div class='py-0.5 mb-3 text-sm'><pre><code class='nix language-nix'>{
  # In `outputs` of `/mnt/etc/nixos/flake.nix`
  nixosConfigurations.nixos = {
    # ...
    modules = [
      ./configuration.nix
      inputs.disko.nixosModules.disko
    ];
  };
}</code></pre></div><div class='flex justify-center items-center mx-auto'><img class='inline mb-3' src='nixos-install-disko/nixos-flake-with-disko.jpeg' alt='/nix/store/1c99jp7g8w8qilv1mpw8sw7s19v6h57f-global/nixos-install-disko/nixos-flake-with-disko.jpeg' style='width: inherit;' /></div>
        </li>
      
        <li>
          
    <p class='mb-3'>
      Move the <code class='py-0.5 px-0.5 bg-gray-100'>disko-config.nix</code> to the flake directory:
    </p>
  <div class='py-0.5 mb-3 text-sm'><pre><code class='bash language-bash'>mv /tmp/disko-config.nix /mnt/etc/nixos</code></pre></div>
        </li>
      
        <li>
          
    <p class='mb-3'>
      Add the disk configuration and use GRUB:
    </p>
  <div class='py-0.5 mb-3 text-sm'><pre><code class='nix language-nix'>{
  # In `/mnt/etc/nixos/configuration.nix`
  imports = [
    ./hardware-configuration.nix
    ./disko-config.nix
  ];
  #boot.loader.systemd-boot.enable = true;
  #boot.loader.efi.canTouchEfiVariables = true;
  boot.loader.grub.enable = true;
  boot.loader.grub.efiSupport = true;
  boot.loader.grub.efiInstallAsRemovable = true;
}</code></pre></div><div class='flex justify-center items-center mx-auto'><img class='inline mb-3' src='nixos-install-disko/nixos-configuration-nix-with-disko-config.jpeg' alt='/nix/store/1c99jp7g8w8qilv1mpw8sw7s19v6h57f-global/nixos-install-disko/nixos-configuration-nix-with-disko-config.jpeg' style='width: inherit;' /></div><div data-callout-metadata data-callout-fold data-callout='info' class='callout bg-opacity-10' role='note'>
  <path d='M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z'>
  </path>
  <div class='callout-title'>
    <div class='callout-icon'>
      <svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round' class='w-5 h-5'>
        <circle cx='12' cy='12' r='10'></circle>
<line x1='12' y1='16' x2='12' y2='12'></line>
<line x1='12' y1='8' x2='12.01' y2='8'></line>
      </svg>
    </div>
    <div class='callout-title-inner'>
      Info
    </div>
  </div>
  <div class='callout-content'>
    
    <p class='mb-3'>
      The boot loader configuration above is compatible with both BIOS and UEFI systems. Additionally, BIOS also requires <a href='https://search.nixos.org/options?channel=23.11&amp;show=boot.loader.grub.device&amp;from=0&amp;size=50&amp;sort=relevance&amp;type=packages&amp;query=boot.loader.grub.device' class='text-green-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>boot.loader.grub.device</a> to be set which is done by <code class='py-0.5 px-0.5 bg-gray-100'>disko</code>’s <code class='py-0.5 px-0.5 bg-gray-100'>nixosModule</code>.
    </p>
  
  </div>
</div>
        </li>
      
    </ul>
  
    <p class='mb-3'>
      Let’s check that our final configuration is correct by using <a href='repl' class='text-green-600 mavenLinkBold hover:underline' data-wikilink-type='WikiLinkNormal'>nix repl</a>. In particular, we test the <code class='py-0.5 px-0.5 bg-gray-100'>fileSystems</code> set by <code class='py-0.5 px-0.5 bg-gray-100'>disko</code>:
    </p>
  <div class='py-0.5 mb-3 text-sm'><pre><code class='sh language-sh'># First, create a flake.lock
sudo nix --experimental-features "nix-command flakes" flake lock

# Start repl
nix --experimental-features "nix-command flakes" repl</code></pre></div><div class='flex justify-center items-center mx-auto'><img class='inline mb-3' src='nixos-install-disko/nixos-disko-filesystems.jpeg' alt='/nix/store/1c99jp7g8w8qilv1mpw8sw7s19v6h57f-global/nixos-install-disko/nixos-disko-filesystems.jpeg' style='width: inherit;' /></div>
    <p class='mb-3'>
      If you see something similar to the above, everything’s good and we are ready to perform the actual installation.
    </p>
  
    <h2 id='install' class='group mt-6 mb-4 font-bold text-gray-700 text-4xl'>
      
  Install NixOS
  
  <a href='nixos-install-disko#install' class='--ema-anchor'>
    <span class='hover:text-green-400 group-hover:visible invisible cursor-pointer text-sm align-middle' aria-label='Copy link'><svg class='inline w-4' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'>
        <path d='M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71'></path>
        <path d='M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71'></path>
      </svg></span>
  </a>


    </h2>
  
    <p class='mb-3'>
      With our NixOS configuration in place, we will use the <code class='py-0.5 px-0.5 bg-gray-100'>nixos-install</code> program to install NixOS:
    </p>
  <div class='py-0.5 mb-3 text-sm'><pre><code class='bash language-bash'>sudo nixos-install --root /mnt --flake '/mnt/etc/nixos#nixos'
# NOTE: You will be prompted to set the root password at this point.
sudo reboot</code></pre></div>
    <p class='mb-3'>
      Once rebooted, you should be greeted with the NixOS login screen, allowing you to login to the machine using the root password you had set.
    </p>
  
    <h2 id='bonus' class='group mt-6 mb-4 font-bold text-gray-700 text-4xl'>
      
  Bonus steps
  
  <a href='nixos-install-disko#bonus' class='--ema-anchor'>
    <span class='hover:text-green-400 group-hover:visible invisible cursor-pointer text-sm align-middle' aria-label='Copy link'><svg class='inline w-4' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'>
        <path d='M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71'></path>
        <path d='M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71'></path>
      </svg></span>
  </a>


    </h2>
  
    <p class='mb-3'>
      This tutorial focused mostly on <a href='https://github.com/nix-community/disko' class='text-green-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>disko</a>, but left some of the things covered in <a href='nixos-install-flake' class='text-green-600 mavenLinkBold hover:underline' data-wikilink-type='WikiLinkNormal'>the previous tutorial</a> which you might want to consider:
    </p>
  
    <ul class='my-3 ml-6 space-y-1 list-disc'>
      
        <li>
          <a href='configuration-as-flake#homedir' class='text-green-600 mavenLinkBold hover:underline'>Move configuration to home dir</a>
        </li>
      
        <li>
          <a href='nixos-install-flake#git' class='text-green-600 mavenLinkBold hover:underline'>Store the configuration on Git</a>
        </li>
      
        <li>
          <a href='nixos-install-flake#enable-flakes' class='text-green-600 mavenLinkBold hover:underline'>Enable flakes</a>
        </li>
      
    </ul>
  
    <h2 id='video' class='group mt-6 mb-4 font-bold text-gray-700 text-4xl'>
      
  Video walkthrough
  
  <a href='nixos-install-disko#video' class='--ema-anchor'>
    <span class='hover:text-green-400 group-hover:visible invisible cursor-pointer text-sm align-middle' aria-label='Copy link'><svg class='inline w-4' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'>
        <path d='M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71'></path>
        <path d='M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71'></path>
      </svg></span>
  </a>


    </h2>
  <div xmlhtmlRaw><center>
<blockquote class="twitter-tweet" data-media-max-width="560"><p lang="en" dir="ltr">Video demo of the install ⤵️ <a href="https://t.co/KJLntZ6CrY">pic.twitter.com/KJLntZ6CrY</a></p>&mdash; Sridhar Ratnakumar (@sridca) <a href="https://twitter.com/sridca/status/1759599633397920219?ref_src=twsrc%5Etfw">February 19, 2024</a></blockquote> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>
</center>
</div>
    <h2 id='end' class='group mt-6 mb-4 font-bold text-gray-700 text-4xl'>
      
  Recap & next steps
  
  <a href='nixos-install-disko#end' class='--ema-anchor'>
    <span class='hover:text-green-400 group-hover:visible invisible cursor-pointer text-sm align-middle' aria-label='Copy link'><svg class='inline w-4' xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'>
        <path d='M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71'></path>
        <path d='M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71'></path>
      </svg></span>
  </a>


    </h2>
  
    <p class='mb-3'>
      You now have a reproducible disk partitioning scheme. This does come at the cost of a few extra manual steps, but you can automate them with a script. Which is what we will do in <a href='nixos-install-oneclick' class='text-green-600 mavenLinkBold hover:underline' data-wikilink-type='WikiLinkNormal'>the next tutorial</a>. We will use <a href='https://github.com/nix-community/nixos-anywhere' class='text-green-600 hover:underline' data-linkicon='external' target='_blank' rel='noopener'>nixos-anywhere</a> to automate the steps above and eliminate the need for a USB flash drive (assuming you have a working Linux system or are booted into a rescue image).
    </p>
  
  <!-- Disabled until we can limit this template to a subset of notes (blog posts):
     https://github.com/nixos-asia/website/issues/9

<aside class="flex items-center justify-center mt-2">
  <ema:metadata>
    <span id="yamlauthor" class="mb-4 text-right text-gray-600">
      Written by
      <value var="author" />
    </span>
  </ema:metadata>
  <script>if (yamlauthor.innerText.includes('error')) yamlauthor.innerText = ''</script>
</aside>
--><div class='flex items-center justify-center mt-2'>
  <div class='flex items-center justify-center mt-2'>
    
      
        <a class='text-gray-300 hover:text-green-600 text-sm' title='Edit this page on GitHub' href='https://github.com/nixos-asia/website/edit/master/en/nixos-install-disko.md'>
          <svg xmlns='http://www.w3.org/2000/svg' class='h-6 w-6' fill='none' viewBox='0 0 24 24' stroke='currentColor'>
            <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z'></path>
          </svg>
        </a>
      
    
  </div>
</div>
</article>
    
    <div class='flex flex-col lg:flex-row lg:space-x-2'>
      
      
  <div class='flex-1 p-4 mt-8 bg-gray-100 rounded'>
    <header class='mb-2 text-xl font-semibold text-gray-500'>Links to this page</header>
    <ul class='space-y-1'>
      
        <li>
          <a class='text-green-600 mavenLinkBold hover:bg-green-50' href='nixos-tutorial'>
            NixOS Tutorial Series
          </a>
          
            <div class='mb-4 overflow-auto text-sm text-gray-500'>
  
    <div class='pl-2 mt-2 border-l-2 border-green-200 hover:border-green-500'>
      <div>
          <svg xmlns='http://www.w3.org/2000/svg' class='inline h-4 w-4 mb-1 text-gray-600 stroke-current fill-current' viewBox='0 0 28 28'><desc>☑</desc><rect stroke-width='3' x='2' y='2' width='24' height='24' rx='3'></rect><path stroke='white' fill='none' stroke-linejoin='round' stroke-width='3.5' d='M7 14 l6 5L22 8'></path></svg>
<span>
  
            <a href='nixos-install-disko' class='text-gray-600 font-bold hover:bg-gray-50' data-wikilink-type='WikiLinkBranch'>Install NixOS with <code>disko</code> disk partitioning</a>
          
</span>
        </div>
    </div>
  
</div>
          
        </li>
      
        <li>
          <a class='text-green-600 mavenLinkBold hover:bg-green-50' href='nixos-install-flake'>
            Install NixOS with Flake configuration on Git
          </a>
          
            <div class='mb-4 overflow-auto text-sm text-gray-500'>
  
    <div class='pl-2 mt-2 border-l-2 border-green-200 hover:border-green-500'>
      <div><p>In <a href='nixos-install-disko' class='text-gray-600 font-bold hover:bg-gray-50' data-wikilink-type='WikiLinkNormal'>the next tutorial</a>, we will automate the install process a bit by declaratively specifying our disk partitioning in Nix.</p></div>
    </div>
  
</div>
          
        </li>
      
        <li>
          <a class='text-green-600 mavenLinkBold hover:bg-green-50' href='nixos-install-oneclick'>
            Install NixOS directly from a remote flake
          </a>
          
            <div class='mb-4 overflow-auto text-sm text-gray-500'>
  
    <div class='pl-2 mt-2 border-l-2 border-green-200 hover:border-green-500'>
      <div><p>Unlike the previous tutorials (<a href='nixos-install-flake' class='text-gray-600 font-bold hover:bg-gray-50' data-wikilink-type='WikiLinkNormal'>1</a>; <a href='nixos-install-disko' class='text-gray-600 font-bold hover:bg-gray-50' data-wikilink-type='WikiLinkNormal'>2</a>), the goal here is to near-fully automate our NixOS install using one command (see the next section).</p></div>
    </div>
  
</div>
          
        </li>
      
    </ul>
  </div>

    </div>
    
  <section class='flex flex-wrap items-end justify-center my-4 space-x-2 space-y-2 font-mono text-sm'>
    
  </section>

    <!-- What goes in this file will at the very end of the main div -->
  </main>
</div>
        </div>
      
      <footer class='flex items-center justify-center mt-2 mb-8 space-x-4 text-center text-gray-800'>
  
  <div>
    <a href='' title='Go to Home page'>
      <svg xmlns='http://www.w3.org/2000/svg' class='w-6 h-6 hover:text-green-700' fill='none' viewBox='0 0 24 24' stroke='currentColor'>
        <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6'></path>
      </svg>
    </a>
  </div>
  <div>
    <a href='-/all' title='View Index'>
      <svg xmlns='http://www.w3.org/2000/svg' class='w-6 h-6 hover:text-green-700' fill='none' viewBox='0 0 24 24' stroke='currentColor'>
        <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253'></path>
      </svg>
    </a>
  </div>
  <div>
    <a href='https://emanote.srid.ca' target='_blank' title='Generated by Emanote 1.3.20.0'>
      <img class='w-6 h-6 hover:text-green-700' src='_emanote-static/emanote-logo.svg' />
    </a>
  </div>
  <div>
    <a href='-/tags' title='View tags'>
      <svg class='w-6 h-6 hover:text-green-700' fill='none' stroke='currentColor' viewBox='0 0 24 24' xmlns='http://www.w3.org/2000/svg'>
        <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z'>
        </path>
      </svg>
    </a>
  </div>
  <div>
    <a href='-/tasks' title='View tasks'>
      <svg xmlns='http://www.w3.org/2000/svg' class='w-6 h-6 hover:text-green-700' fill='none' viewBox='0 0 24 24' stroke='currentColor'>
        <path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z'></path>
      </svg>
    </a>
  </div>
</footer>
    </div>
  
  <div id='stork-search-container' class='hidden fixed w-screen h-screen inset-0 backdrop-filter backdrop-blur-sm'>
  <div class='fixed w-screen h-screen inset-0' onclick='window.emanote.stork.toggleSearch()'></div>

  <div class='container mx-auto p-10 mt-10'>
    <div class='stork-wrapper-flat container mx-auto'>
      <input id='stork-search-input' data-stork='emanote-search' class='stork-input' placeholder='Search (Ctrl+K) ...' />
      <div data-stork='emanote-search-output' class='stork-output'></div>
    </div>
  </div>
</div>
  
    
  
</body>

</html>
